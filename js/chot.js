$(function(){$(".chot-head-span").on("click",function(){$(this).addClass("chot-head-span-color").siblings().removeClass("chot-head-span-color");var s=$(this).index();$(".chot-box").eq(s).show().siblings().hide(),0==s?($(".chot-frist-frist-div").empty(),$(".chot-frist-two").empty(),$(".community-second-shows-center").empty(),i()):1==s?($(".chot-two").empty(),o=1,c(),o=2,c()):3==s&&($(".chot-four").empty(),p=1,l())});var s="";function t(){var s=$("#chot-header-text").val();window.location="chotOver.html?keyword="+s}function i(){$.ajax({type:"post",url:"me/hotsearch-all",async:!0,data:{keyword:s},success:function(s){if(0==s.state){console.log(s);for(var t=0;t<s.data.length;t++){var i=s.data[t];if(1==i.type)if(null!=i.subData)for(var o=0;o<i.subData.length&&4!=o;o++){var n="";n+="<p class='chot-frist-frist-pp' uid='"+i.subData[o].uid+"'>",n+="<span class='chot-frist-frist-pp-span'  uid='"+i.subData[o].uid+"'>",n+=`<img src='${i.subData[o].icon}' class='chot-frist-frist-img1'  onerror="this.onerror=null; this.src='../images/w-yuan.jpg'"/>`,n+="<span class='chot-frist-frist-pp-span-span'>"+i.subData[o].nickName+"</span>",n+="</span>",0==i.subData[o].isFollow?n+="<img src='images/weiguanbai.png' class='chot-frist-frist-img2' uid='"+i.subData[o].uid+"'/>":1==i.subData[o].isFollow&&(n+="<img src='images/yiguanhei.png' class='chot-frist-frist-img2' uid='"+i.subData[o].uid+"'/>"),n+="</p>",$(".chot-frist-frist-div").append(n)}else $(".chot-frist-frist-div").hide();else if(3==i.type)if(null!=i.subData){for(var e=0;e<i.subData.length;e++){var c="";c+="<div class='chot-frist-two-div' tid='"+i.subData[e].tid+"'>",c+="<img src='images/huati.png' class='chot-frist-two-img1'/>",c+="<div>",c+="<p>"+i.subData[e].name+"</p>",c+="<p>"+i.subData[e].joins+"加入</p>",c+="</div>",c+="</div>"}$(".chot-frist-two").append(" <div class='community-second-shows-p'><span></span><span>话题</span><span></span></div>"+c)}else $(".chot-frist-two").hide();else if(2==i.type)if(null!=i.subData)for(var m=0;m<i.subData.length;m++){var d="";d+="<div class='community-second-shows-imgs'  wid='"+i.subData[m].wid+"'>",d+="<div class='community-second-shows-imgs1'  wid='"+i.subData[m].wid+"'>",d+=`<img src='${i.subData[m].image}' class='community-second-shows-img'  onerror="this.onerror=null; this.src='../images/w-meishijingxuan.png'"/>`,d+="<p class='community-second-shows-imgs-p'>",d+="<span>"+i.subData[m].content+"</span>",d+="<span class='community-second-shows-imgs-pp' tid='"+i.subData[m].tid+"'>"+i.subData[m].tname+"</span>",d+="</p>",d+="</div>",d+="<p class='community-second-shows-imgs-ppp'>",0==i.subData[m].isLike?(d+="<img src='images/zanh.png' class='community-second-shows-imgs-p-inzan'  wid='"+i.subData[m].wid+"'/>",d+="<span class='community-second-shows-imgs-p-span1 community-frist-bot-likes community-black'>"+i.subData[m].likes+"</span>"):1==i.subData[m].isLike&&(d+="<img src='images/inzan.png' class='community-second-shows-imgs-p-inzan'  wid='"+i.subData[m].wid+"'/>",d+="<span class='community-second-shows-imgs-p-span1  community-frist-bot-likes community-red'>"+i.subData[m].likes+"</span>"),d+="<img src='images/ic_index_03.png' class='community-second-shows-imgs-p-ic_index_03' wid='"+i.subData[m].wid+"'/>",d+="<span class='community-second-shows-imgs-p-span2 '>"+i.subData[m].comments+"</span>",d+="</p>",d+="</div>",$(".community-second-shows-center").append(d)}else $(".community-second-shows-center").hide()}homepages($(".chot-frist-frist-pp-span")),topic($(".community-second-shows-imgs-pp")),topic($(".community-second-shows-pp")),topic($(".chot-frist-two-div")),postint($(".community-second-shows-imgs-p-ic_index_03")),zan($(".community-second-shows-imgs-p-inzan")),a($(".chot-frist-frist-img2")),$(".community-second-shows-imgs1").on("click",function(s){var t=(s=s||window.event).target;"community-second-shows-imgs-pp"==$(t).attr("class")?window.location="topic.html?tid="+$(t).attr("tid"):window.location="postint.html?wid="+$(this).attr("wid")})}else $(".chot-frist").html("<div class='div-none'><img src='img/sanheyi@2x.png' alt=''><p>没有搜到相关话题哦，可以换个关键词试试看</p><div>")},error:function(){alert("请求超时")}})}function a(s){s.on("click",function(){var s=$(this).attr("uid"),t=$(this);"images/weiguanbai.png"==t.attr("src")?$.ajax({type:"post",url:"me/follow",async:!0,dataType:"json",data:{uid:s,type:1},success:function(s){"成功"==s.stateMsg?t.attr("src","images/yiguanhei.png"):($(".black").text(s.stateMsg).show(),setTimeout(function(){$(".black").hide()},1500))},error:function(s){}}):"images/yiguanhei.png"==t.attr("src")&&$.ajax({type:"post",url:"me/follow",async:!0,dataType:"json",data:{uid:s,type:0},success:function(s){"成功"==s.stateMsg?t.attr("src","images/weiguanbai.png"):($(".black").text(s.stateMsg).show(),setTimeout(function(){$(".black").hide()},1500))},error:function(s){}})})}$(".chot-header-text-span").on("click",function(){""!=$("#chot-header-text").val()&&null!=$("#chot-header-text").val()&&t()}),$(document).keydown(function(s){13==s.keyCode&&""!=$("#chot-header-text").val()&&null!=$("#chot-header-text").val()&&t()});var o=1,n=null,e=!0;function c(){e=!1,$.ajax({type:"post",url:"/me/search/user",async:!0,data:{keyword:s,pageId:o},success:function(s){if(0==s.state){for(var t=0;t<s.data.items.length;t++){var i="";i+="<p class='chot-frist-frist-pp' uid='"+s.data.items[t].uid+"'>",i+="<span class='chot-frist-frist-pp-span' uid='"+s.data.items[t].uid+"'>",i+=`<img src='${s.data.items[t].icon}' class='chot-frist-frist-img1' onerror="this.onerror=null; this.src='../images/w-yuan.jpg'"/>`,i+="<span class='chot-frist-frist-pp-span-span'>"+s.data.items[t].nickName+"</span>",i+="</span>",0==s.data.items[t].isFollow?i+="<img class='chot-two-frist-img2' src='images/weiguanbai.png' uid='"+s.data.items[t].uid+"'/>":1==s.data.items[t].isFollow&&(i+="<img class='chot-two-frist-img2' src='images/yiguanhei.png'  uid='"+s.data.items[t].uid+"'/>"),i+="</p>",$(".chot-two").append(i)}s.data.pageTotal>o?o=s.data.pageCurr+1:($(".community-bottom").text("已经到底了"),setTimeout(function(){$(".community-bottom").hide()},2e3),setInterval(function(){e=!1},100))}else 1==o&&$(".chot-two").html("<div class='div-none'><img src='img/yonghusousuo@2x.png' alt=''><p>没有搜到相关用户哦，可以换个关键词试试看</p><div>");$(".chot-frist-frist-pp-span").on("click",function(){window.location="homepages.html?uid="+$(this).attr("uid")}),a($(".chot-two-frist-img2"))},complete:function(){clearTimeout(n),n=setTimeout(function(){e=!0},250)},error:function(){alert("请求超时")}})}var m=!0,d=1;function r(){m=!1,$.ajax({type:"post",url:"/me/search/topic",async:!0,data:{keyword:s,pageId:d},success:function(s){if(0==s.state){for(var t=0;t<s.data.items.length;t++){var i="";i+="<div class='chot-frist-two-div chot-frist-two-div1' tid='"+s.data.items[t].tid+"'>",i+="<img src='images/huati.png' class='chot-frist-two-img1'/>",i+="<div>",i+="<p>"+s.data.items[t].name+"</p>",i+="<p>"+s.data.items[t].joins+"人加入</p>",i+="</div>",i+="</div>",$(".chot-three").append(i)}$(".chot-frist-two-div1").on("click",function(){window.location="topic.html?tid="+$(this).attr("tid")}),s.data.pageTotal>d?d=s.data.pageCurr+1:setInterval(function(){m=!1},100)}else 1==d&&$(".chot-three").html("<div class='div-none'><img src='img/sanheyi@2x.png' alt=''><p>没有搜到相关话题哦，可以换个关键词试试看</p><div>")},complete:function(){clearTimeout(s);var s=setTimeout(function(){m=!0},200)},error:function(){alert("请求超时")}})}var p=1,u=!0;function l(){u=!1,$.ajax({type:"post",url:"/me/search/weibo",async:!0,data:{keyword:s,pageId:p},success:function(s){if(0==s.state){for(var t=0;t<s.data.items.length;t++){var i="";i+="<div class='community-second-shows-imgs'  wid='"+s.data.items[t].wid+"'>",i+="<div class='community-second-shows-imgs1' wid='"+s.data.items[t].wid+"'>",i+=`<img src='${s.data.items[t].image}' class='community-second-shows-img'  onerror="this.onerror=null; this.src='../images/w-meishijingxuan.png'"/>`,i+="<p class='community-second-shows-imgs-p'>"+s.data.items[t].content+"<span class='community-second-shows-imgs-pp' tid='"+s.data.items[t].tid+"'>"+s.data.items[t].tname+"</span></p>",i+="</div>",i+="<p class='community-second-shows-imgs-ppp'>",0==s.data.items[t].isLike?(i+="<img src='images/zanh.png' class='community-second-shows-imgs-p-i'  wid='"+s.data.items[t].wid+"'/>",i+="<span class='community-second-shows-imgs-p-span1  community-frist-bot-likes community-black'>"+s.data.items[t].likes+"</span>"):1==s.data.items[t].isLike&&(i+="<img src='images/inzan.png' class='community-second-shows-imgs-p-i'   wid='"+s.data.items[t].wid+"'/>",i+="<span class='community-second-shows-imgs-p-span1 community-frist-bot-likes community-red'>"+s.data.items[t].likes+"</span>"),i+="<img src='images/ic_index_03.png' class='community-second-shows-imgs-p-ic_index_03' wid='"+s.data.items[t].wid+"'/>",i+="<span class='community-second-shows-imgs-p-span2'>"+s.data.items[t].comments+"</span>",i+="</p>",i+="</div>",$(".chot-four").append(i)}$(".community-second-shows-imgs1").on("click",function(s){var t=(s=s||window.event).target;"community-second-shows-imgs-pp"==$(t).attr("class")?window.location="topic.html?tid="+$(t).attr("tid"):window.location="postint.html?wid="+$(this).attr("wid")}),zan($(".community-second-shows-imgs-p-i")),postint($(".community-second-shows-imgs-p-ic_index_03")),s.data.pageTotal>p?p=s.data.pageCurr+1:setInterval(function(){u=!1},100)}else 1==p&&$(".chot-four").html("<div class='div-none'><img src='../img/sanheyi@2x.png' alt=''><p>没有搜到相关帖子哦，可以换个关键词试试看</p><div>")},complete:function(){clearTimeout(n),setTimeout(function(){u=!0},200)},error:function(){alert("请求超时")}})}i(),c(),r(),l(),$(window).on("scroll",function(){Math.ceil($(window).scrollTop())>=$(document).height()-$(window).height()&&(1==m?r():1==e?c():1==u&&l())}),rank(),wx.ready(function(){share("大鱼优品购物社区-购物分享社交平台","我在大鱼优选社区，赶快跟我来看看大家都买了什么好物吧~",dyyp.DOMAIN+"/community1.html?random="+(new Date).toLocaleTimeString(),dyyp.DOMAIN+"/img/new.jpg")})});