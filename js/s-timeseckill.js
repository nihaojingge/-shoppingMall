$(function(){var s=GetQueryString("specialId");s=null!=s?GetQueryString("specialId"):"";var i=1,e=!0,a=null,l=null,t="",o=[];function p(){$.ajax({type:"post",url:"/me/seckill-info",async:!0,success:function(i){for(var e in i.data){var a=i.data;if(s==a[e].specialId)var t=a[e].timeTostart,o=a[e].timeToEnd}if(o<0){var p=$("<span class='timeSeckill-shows-middle-span2' style='color:#666666;font-size:2.8rem;font-family: PingFangSC-Regular;'>亲，本场已结束哦</span>");$(".timeSeckill-shows-middle").append(p)}else if(o>0)if(t<0){"<span class='timeSeckill-shows-middle-span1'>火热抢购中</span>","<span class='timeSeckill-shows-middle-span-fix'>","<span class='timeSeckill-shows-middle-span-txt'>","</span>","<span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spana'>00</span>","<span> : </span>","<span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spanb'>00</span>","<span> : </span>","<span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spanc'>00</span>","</span>",$(".timeSeckill-shows-middle").append("<span class='timeSeckill-shows-middle-span1'>火热抢购中</span><span class='timeSeckill-shows-middle-span-fix'><span class='timeSeckill-shows-middle-span-txt'></span><span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spana'>00</span><span> : </span><span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spanb'>00</span><span> : </span><span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spanc'>00</span></span>");var n=o/1e3}else if(t>0){"<span class='timeSeckill-shows-middle-span1'>抢购即将开始哦</span>","<span class='timeSeckill-shows-middle-span-fix'>","<span class='timeSeckill-shows-middle-span-txt'>","</span>","<span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spana'>00</span>","<span> : </span>","<span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spanb'>00</span>","<span> : </span>","<span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spanc'>00</span>","</span>",$(".timeSeckill-shows-middle").append("<span class='timeSeckill-shows-middle-span1'>抢购即将开始哦</span><span class='timeSeckill-shows-middle-span-fix'><span class='timeSeckill-shows-middle-span-txt'></span><span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spana'>00</span><span> : </span><span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spanb'>00</span><span> : </span><span class='timeSeckill-shows-middle-span3  timeSeckill-shows-middle-spanc'>00</span></span>");n=t/1e3;console.log(n)}l=setInterval(function(){n--;var s=parseInt(n/3600/24);console.log(s);var i=parseInt(n/3600%24),e=parseInt(n/60%60),a=parseInt(n%60);t>0?s>0?$(".timeSeckill-shows-middle-span-txt").html("距 开 始 "+s+" 天 "):$(".timeSeckill-shows-middle-span-txt").html("距 开 始："):s>0?$(".timeSeckill-shows-middle-span-txt").html("距 本 场 结 束 "+s+" 天 "):$(".timeSeckill-shows-middle-span-txt").html("距 本 场 结 束："),i<10?$(".timeSeckill-shows-middle-spana").html("0"+i):$(".timeSeckill-shows-middle-spana").html(i),e<10?$(".timeSeckill-shows-middle-spanb").html("0"+e):$(".timeSeckill-shows-middle-spanb").html(e),a<10?$(".timeSeckill-shows-middle-spanc").html("0"+a):$(".timeSeckill-shows-middle-spanc").html(a),i<=0&&e<=0&&a<=0&&(clearInterval(l),l=null,window.location.reload())},1e3)},error:function(s){}})}function n(){e=!1,$.ajax({type:"post",url:"/me/seckill-product",data:{seckillId:s,pageId:i,sss:t},async:!0,success:function(a){if(console.log(a),0==a.state){if(window.sessionStorage.setItem("specialId",s),0==t)for(var l in a.data.items){var o="";o+="<div class='timeSeckill-shows-bottom-box' data-pid = '"+(n=a.data.items)[l].productId+"' data-specialId='"+s+"' >",o+=`<img src='${n[l].productImage}' class="timeSeckill-shows-bottom-box-img" onerror="this.onerror=null; this.src='img/s-qianggou.png'"/>`,0==n[l].residuaQuantity&&(o+="<img src='img/yiqiangguang' class='timeSeckill-shows-bottom-box-fox  '/>"),o+="<div class='timeSeckill-shows-bottom-box-div'>",o+="<p class='timeSeckill-shows-bottom-box-div-p'>"+n[l].productName+"</p>",o+="<p class='timeSeckill-shows-bottom-box-div-pp' style='display:inline-block;font-size: 2rem;color: #666666'>&nbsp;<p/>",o+="<p class='timeSeckill-shows-bottom-box-div-ppp'>",o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span1'>&yen;"+n[l].price+"</span>",o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span2'><s>&yen;"+n[l].beforePrice+"</s></span>",1==t&&(n[l].residuaQuantity>0?o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span3'>去抢购</span>":o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span4'>去抢购</span>"),o+="<span class='timeSeckill-shows-bottom-box-div-pp' style='display:inline-block;font-size: 2.8rem;color: #666666;background:#f5f5f5;padding:0.5rem 2rem;float: right;border-radius: 0.8rem;font-family: PingFangSC-Medium'>已结束<span/>",o+="</p>",o+="</div>",o+="</div>",$(".timeSeckill-shows-bottom").append(o);var p=100*n[l].saleProcess+"%";$(".timeSeckill-shows-bottom-box-div-pp-span1-span").css("width",p)}else if(1==t)for(var l in a.data.items){o="";o+="<div class='timeSeckill-shows-bottom-box' data-pid = '"+(n=a.data.items)[l].productId+"' data-specialId='"+s+"' >",o+=`<img src='${n[l].productImage}' class="timeSeckill-shows-bottom-box-img" onerror="this.onerror=null; this.src='img/s-qianggou.png'"/>`,0==n[l].residuaQuantity&&(o+="<img src='img/yiqiangguang.png' class='timeSeckill-shows-bottom-box-fox  '/>"),o+="<div class='timeSeckill-shows-bottom-box-div'>",o+="<p class='timeSeckill-shows-bottom-box-div-p'>"+n[l].productName+"</p>",o+="<p class='timeSeckill-shows-bottom-box-div-pp'>",n[l].saleProcess<0&&(n[l].saleProcess=0),o+="<span class='timeSeckill-shows-bottom-box-div-pp-span1'><span class='timeSeckill-shows-bottom-box-div-pp-span1-span' style='width: "+(100*(1-Number(n[l].saleProcess))+"%")+"'></span></span>",o+="<span class='timeSeckill-shows-bottom-box-div-pp-span2' >剩余"+n[l].residuaQuantity+"件</span>",o+="</p>",o+="<p class='timeSeckill-shows-bottom-box-div-ppp'>",o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span1'>&yen;"+n[l].price+"</span>",o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span2'><s>&yen;"+n[l].beforePrice+"</s></span>",1==t&&(o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span3'>去抢购</span>"),o+="</p>",o+="</div>",o+="</div>",$(".timeSeckill-shows-bottom").append(o)}else if(2==t)for(var l in a.data.items){var n;o="";o+="<div class='timeSeckill-shows-bottom-box' data-pid = '"+(n=a.data.items)[l].productId+"' data-specialId='"+s+"' >",o+=`<img src='${n[l].productImage}' class="timeSeckill-shows-bottom-box-img" onerror="this.onerror=null; this.src='img/s-qianggou.png'"/>`,0==t&&(o+="<img src='img/jieshu.png' class='timeSeckill-shows-bottom-box-fox  '/>"),0==n[l].residuaQuantity&&(o+="<img src='img/qiangwan.png' class='timeSeckill-shows-bottom-box-fox  '/>"),o+="<div class='timeSeckill-shows-bottom-box-div'>",o+="<p class='timeSeckill-shows-bottom-box-div-p'>"+n[l].productName+"</p>",o+="<p class='timeSeckill-shows-bottom-box-div-pp'>",o+="<span class='timeSeckill-shows-bottom-box-div-pp-span1'><span class='timeSeckill-shows-bottom-box-div-pp-span1-span' style='width: "+(p=100*(1-Number(n[l].saleProcess))+"%")+"'></span></span>",o+="<span  style='color: #444;font-size: 2.4rem;font-family: PingFangSC-Regular'>限量"+n[l].residuaQuantity+"件</span>",o+="</p>",o+="<p class='timeSeckill-shows-bottom-box-div-ppp'>",o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span1'>&yen;"+n[l].price+"</span>",o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span2'><s>&yen;"+n[l].beforePrice+"</s></span>",1==t&&(o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span3'>去抢购</span>"),o+="<span class='timeSeckill-shows-bottom-box-div-ppp-span3'>即将开始</span>",o+="</p>",o+="</div>",o+="</div>",$(".timeSeckill-shows-bottom").append(o)}$(".timeSeckill-shows-bottom-box").on("click",function(){var s=$(this).attr("data-specialId");window.location=null==s?"s-seckilldetails.html?pid="+$(this).attr("data-pid")+"&random="+(new Date).getTime():"s-seckilldetails.html?pid="+$(this).attr("data-pid")+"&specialId="+$(this).attr("data-specialId")+"&activityType=1&random="+(new Date).getTime()}),a.data.pageTotal>i?i=a.data.pageId+1:setInterval(function(){e=!1},100)}else $(".timeSeckill-shows-bottom").html($("<div class='div-none'><img src='img/xitongchucuo.png' alt=''><p>抱歉，暂无相关商品~  &nbsp; 去看看其它活动吧</p><div>"))},complete:function(){clearTimeout(a),setTimeout(function(){e=!0},150)},error:function(s){}})}$.ajax({type:"post",url:"/me/seckill-info",async:!1,success:function(e){console.log(e.data);var a="";for(var c in a=e.data.length>5?5:e.data.length,e.data){var m=e.data[c].specialStatus;o.push(m)}if("-1"==o.indexOf(1)){var d=o.indexOf(2);for(var c in e.data){console.log("即将开始",c);var r="";r+="<div class='swiper-slide'>",r+="<div class='timeSeckill-shows-top-box' data-sid = '"+(w=e.data)[c].specialId+"' data-sus = '"+w[c].specialStatus+"' data-start = '"+w[c].timeTostart+"' data-end='"+w[c].timeToEnd+"'>",2==w[c].specialStatus&&c==d?(r+="<p class='timeSeckill-shows-top-box-color'>"+w[c].startTime+"</p>",r+="<p class='timeSeckill-shows-top-box-color'>"+w[c].remarkInfo+"</p>",w[c].specialStatus):(r+="<p>"+w[c].startTime+"</p>",r+="<p>"+w[c].remarkInfo+"</p>"),$(".timeSeckill-shows .swiper-wrapper").append(r),t=2}}else{var h=o.indexOf(1);for(var c in e.data){var w=e.data;console.log(w);r="";r+="<div class='swiper-slide'>",r+="<div class='timeSeckill-shows-top-box' data-sid = '"+w[c].specialId+"' data-sus = '"+w[c].specialStatus+"' data-start = '"+w[c].timeTostart+"' data-end='"+w[c].timeToEnd+"'>",1==w[c].specialStatus&&c==h?(r+="<p class='timeSeckill-shows-top-box-color'>"+w[c].startTime+"</p>",r+="<p class='timeSeckill-shows-top-box-color'>"+w[c].remarkInfo+"</p>",w[c].specialStatus):(r+="<p>"+w[c].startTime+"</p>",r+="<p>"+w[c].remarkInfo+"</p>"),$(".timeSeckill-shows .swiper-wrapper").append(r)}t=1}s=$(".timeSeckill-shows-top-box-color").parent().attr("data-sid"),n(),$(".timeSeckill-shows-top-box").on("click",function(){$(this).children().addClass("timeSeckill-shows-top-box-color").parent().parent().siblings().children().children().removeClass("timeSeckill-shows-top-box-color"),s=$(this).attr("data-sid"),t=$(this).attr("data-sus"),$(".timeSeckill-shows-middle").empty(),clearInterval(l),l=null,p(),i=1,$(".timeSeckill-shows-bottom").empty(),n()});new Swiper(" .timeSeckill-all .timeSeckill-shows-top .swiper-container",{pagination:".swiper-pagination",slidesPerView:a,paginationClickable:!0})},error:function(s){}}),p(),$(window).on("scroll",function(){Math.ceil($(window).scrollTop()+1)>=$(document).height()-$(window).height()&&1==e&&n()}),addRefereeCode()});